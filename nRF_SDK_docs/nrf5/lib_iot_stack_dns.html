<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>nRF5 SDK v15.3.0: Domain Name System Client (DNS)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
<link rel="Shortcut icon" href="./favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF5 SDK
   &#160;<span id="projectnumber">v15.3.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<table cellspacing="0" cellpadding="0" class="blank">
<tr>
<td class="doclinkintro">Choose documentation:</td>
<td class="doclinks" id="nrf5"><a href="../nrf5/index.html">nRF5 SDK</a></td>
<td class="doclinks" id="s112"><a href="../s112/index.html">S112 SoftDevice API</a></td>
<td class="doclinks" id="s132"><a href="../s132/index.html">S132 SoftDevice API</a></td>
<td class="doclinks" id="s140"><a href="../s140/index.html">S140 SoftDevice API</a></td>
<td class="doclinks" id="s212"><a href="../s212/index.html">S212 SoftDevice API</a></td>
<td class="doclinks" id="s312"><a href="../s312/index.html">S312 SoftDevice API</a></td>
<td class="doclinks" id="s332"><a href="../s332/index.html">S332 SoftDevice API</a></td>
<td class="doclinks" id="s340"><a href="../s340/index.html">S340 SoftDevice API</a></td>
</tr>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s112","s132","s140","s212","s312","s332","s340"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('lib_iot_stack_dns.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Domain Name System Client (DNS) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#IOT_DNS_CALLBACK">Asynchronous Event Notification Callback on query</a></li>
<li class="level1"><a href="#IOT_DNS_CODE">Code examples</a><ul><li class="level2"><a href="#IOT_DNS_CODE_1">Initialization of the DNS Module</a></li>
<li class="level2"><a href="#IOT_DNS_CODE_2">DNS Query to obtain the IPv6 address of example.com domain.</a></li>
</ul>
</li>
<li class="level1"><a href="#IOT_DNS_CONF">Configuration parameters</a><ul><li class="level2"><a href="#DNS6_DISABLE_LOGS"></a></li>
<li class="level2"><a href="#DNS6_DISABLE_API_PARAM_CHECK"></a></li>
<li class="level2"><a href="#DNS6_MAX_PENDING_QUERIES"></a></li>
<li class="level2"><a href="#DNS6_MAX_RETRANSMISSION_COUNT"></a></li>
<li class="level2"><a href="#DNS6_RETRANSMISSION_INTERVAL"></a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><div class="whichSDs"><span>This information applies to the following SoftDevice: <b>S132</b></span></div><p>The DNS client module provides the functionality for obtaining DNS AAAA (IPv6) records from the authoritative DNS server. The module performs queries for the IPv6 addresses of the given hostname (e.g. <em>example.com</em>).</p>
<p>Each query can be assigned with a separate application callback that informs about the IPv6 addresses found, DNS frame error or DNS Server problem.</p>
<p>The module realizes a retry mechanism to improve chances of resolving the DNS Query. The number of retries is configurable using the <a class="el" href="lib_iot_stack_dns.html#DNS6_MAX_RETRANSMISSION_COUNT">DNS6_MAX_RETRANSMISSION_COUNT</a>. The interval between retries is determined by the configurable parameter <a class="el" href="lib_iot_stack_dns.html#DNS6_RETRANSMISSION_INTERVAL">DNS6_RETRANSMISSION_INTERVAL</a>. Therefore, an application can expect to wait for ((<a class="el" href="lib_iot_stack_dns.html#DNS6_MAX_RETRANSMISSION_COUNT">DNS6_MAX_RETRANSMISSION_COUNT</a> + 1) * <a class="el" href="lib_iot_stack_dns.html#DNS6_RETRANSMISSION_INTERVAL">DNS6_RETRANSMISSION_INTERVAL</a>) before the query is resolved. If no response is received after the maximum number of retries, the application is notified of process result DNS6_SERVER_UNREACHABLE in the event notification callback.</p>
<dl class="section note"><dt>Note</dt><dd>The DNS module is implemented on top of the <a class="el" href="lib_iot_stack_udp.html">UDP module</a>. Therefore, an additional UDP socket has to be allocated for the DNS module to work. </dd>
<dd>
The retry mechanism requires the <a class="el" href="lib_iot_timer.html">IoT Timer</a> module to be present.</dd></dl>
<h1><a class="anchor" id="IOT_DNS_CALLBACK"></a>
Asynchronous Event Notification Callback on query</h1>
<p>The user DNS callback informs about the internal process result, which can be either NRF_SUCCESS or one of the following errors:</p>
<table class="doxtable">
<tr>
<th>Process result </th><th>Description </th></tr>
<tr>
<td>DNS6_SERVER_UNREACHABLE </td><td>No response from the DNS Server has been received. </td></tr>
<tr>
<td>DNS6_FORMAT_ERROR </td><td>The DNS Server was unable to interpret the query. </td></tr>
<tr>
<td>DNS6_SERVER_FAILURE </td><td>The DNS Server was unable to process the query. </td></tr>
<tr>
<td>DNS6_HOSTNAME_NOT_FOUND </td><td>No IPv6 addresses have been found. </td></tr>
<tr>
<td>DNS6_NOT_IMPLEMENTED </td><td>The DNS Server does not support the requested kind of query. </td></tr>
<tr>
<td>DNS6_REFUSED_ERROR </td><td>The DNS Server refuses to perform the query. </td></tr>
<tr>
<td>DNS6_RESPONSE_TRUNCATED </td><td>Response from the DNS Server is truncated. </td></tr>
<tr>
<td>Other </td><td>In case the DNS module is not the source of an error. </td></tr>
</table>
<h1><a class="anchor" id="IOT_DNS_CODE"></a>
Code examples</h1>
<h2><a class="anchor" id="IOT_DNS_CODE_1"></a>
Initialization of the DNS Module</h2>
<p>This code example shows how to set up the DNS Client in order to send a DNS Query and receive responses. In the example below, Google's DNS Server is used.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> app_dns_client_init(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    uint32_t err_code;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Configure DNS Client and Server parameters.</span></div>
<div class="line">    <a class="code" href="structdns6__init__t.html" title="Initialization parameters type.">dns6_init_t</a> dns_init_param =</div>
<div class="line">    {</div>
<div class="line">        .<a class="code" href="structdns6__init__t.html#aaa0ff49587b3edafe98e28b150646b56">local_src_port</a>  = 0x8888,</div>
<div class="line">        .dns_server      =</div>
<div class="line">        {</div>
<div class="line">            .port = 53,</div>
<div class="line">            .addr = {{0x20, 0x01, 0x48, 0x60, 0x48, 0x60, 0x00, 0x00,</div>
<div class="line">                      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x88, 0x88}}</div>
<div class="line">        }</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Init DNS client.</span></div>
<div class="line">    err_code = <a class="code" href="group__iot__dns6.html#gae2ef9658e0164ffd46b3d11c832ce3ad" title="Function for initializing DNS6 module.">dns6_init</a>(&amp;dns_init_param);</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="IOT_DNS_CODE_2"></a>
DNS Query to obtain the IPv6 address of example.com domain.</h2>
<p>This code example shows how to send a DNS Query for resolving the given hostname. The application is informed about the status of the DNS process in a user-defined function.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> app_dns_handler(uint32_t      process_result,</div>
<div class="line">                     <span class="keyword">const</span> <span class="keywordtype">char</span>  * p_hostname,</div>
<div class="line">                     <a class="code" href="unionipv6__addr__t.html">ipv6_addr_t</a> * p_addr,</div>
<div class="line">                     uint16_t      addr_count)</div>
<div class="line">{</div>
<div class="line">    uint32_t index;</div>
<div class="line"></div>
<div class="line">    APPL_LOG(<span class="stringliteral">&quot;\r\nDNS Response for hostname: %s, with %d IPv6 addresses and status 0x%08lX\r\n&quot;</span>,</div>
<div class="line">             p_hostname, addr_count, process_result);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(process_result == <a class="codeRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group__nrf__error.html#ga7e6367efeaac363d8cf024940b4ec123">NRF_SUCCESS</a>)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span> (index = 0; index &lt; addr_count; index++)</div>
<div class="line">        {</div>
<div class="line">            APPL_LOG(<span class="stringliteral">&quot;[%d] IPv6 Address: &quot;</span>, index);</div>
<div class="line">            APPL_ADDR(p_addr[index]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> app_resolve(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Find all IPv6 addresses correspond to example.com domain.</span></div>
<div class="line">    err_code = <a class="code" href="group__iot__dns6.html#ga4e73e36291c3bfb580e592720364feea" title="Function for querying given URL string to DNS server, in order to get IPv6 address of given hostname...">dns6_query</a>(<span class="stringliteral">&quot;example.com&quot;</span>, app_dns_handler);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="IOT_DNS_CONF"></a>
Configuration parameters</h1>
<p>The following configuration parameters should be defined in <code>sdk_config.h</code>.</p>
<h2><a class="anchor" id="DNS6_DISABLE_LOGS"></a>
DNS6_DISABLE_LOGS</h2>
<p>Disables debug tracing in the module. To enable tracing, this flag must be set to 0 and NRF_LOG_ENABLED must be set to 1. </p>
<table class="doxtable">
<tr>
<th>Description </th><th>Value </th></tr>
<tr>
<td>Enable debug trace </td><td>0 </td></tr>
<tr>
<td>Disable debug trace </td><td>1 </td></tr>
<tr>
<td>Dependencies </td><td>NRF_LOG_ENABLED </td></tr>
</table>
<h2><a class="anchor" id="DNS6_DISABLE_API_PARAM_CHECK"></a>
DNS6_DISABLE_API_PARAM_CHECK</h2>
<p>Disables API parameter checks in the module. Set this define to 1 to disable checks on API parameters in the module.</p>
<p>API parameter checks are added to ensure that the correct parameters are passed to the module. These checks are useful during development phase, but they might be redundant when the application is finalized. Disabling these checks might improve performance. </p>
<table class="doxtable">
<tr>
<th>Description </th><th>Value </th></tr>
<tr>
<td>Enable API parameters check </td><td>0 </td></tr>
<tr>
<td>Disable API parameters check </td><td>1 </td></tr>
<tr>
<td>Dependencies </td><td>None </td></tr>
</table>
<h2><a class="anchor" id="DNS6_MAX_PENDING_QUERIES"></a>
DNS6_MAX_PENDING_QUERIES</h2>
<p>Maximum number of pending queries in a queue.</p>
<table class="doxtable">
<tr>
<th>Description </th><th>Value </th></tr>
<tr>
<td>Minimum value </td><td>1 </td></tr>
<tr>
<td>Maximum value </td><td>65534 </td></tr>
<tr>
<td>Dependencies </td><td>None </td></tr>
</table>
<h2><a class="anchor" id="DNS6_MAX_RETRANSMISSION_COUNT"></a>
DNS6_MAX_RETRANSMISSION_COUNT</h2>
<p>Maximum number of retransmissions on a single query. Set this define to 0 to disable retransmission attempts.</p>
<table class="doxtable">
<tr>
<th>Description </th><th>Value </th></tr>
<tr>
<td>Minimum value </td><td>0 </td></tr>
<tr>
<td>Maximum value </td><td>255 </td></tr>
<tr>
<td>Dependencies </td><td>None </td></tr>
</table>
<h2><a class="anchor" id="DNS6_RETRANSMISSION_INTERVAL"></a>
DNS6_RETRANSMISSION_INTERVAL</h2>
<p>Interval between retransmissions in seconds.</p>
<table class="doxtable">
<tr>
<th>Description </th><th>Value </th></tr>
<tr>
<td>Minimum value </td><td>2 </td></tr>
<tr>
<td>Maximum value </td><td>None </td></tr>
<tr>
<td>Dependencies </td><td>None </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Fri Feb 15 2019" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
