<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>nRF5 SDK v15.3.0: Transport Layer Security on nRF5</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
<link rel="Shortcut icon" href="./favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF5 SDK
   &#160;<span id="projectnumber">v15.3.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<table cellspacing="0" cellpadding="0" class="blank">
<tr>
<td class="doclinkintro">Choose documentation:</td>
<td class="doclinks" id="nrf5"><a href="../nrf5/index.html">nRF5 SDK</a></td>
<td class="doclinks" id="s112"><a href="../s112/index.html">S112 SoftDevice API</a></td>
<td class="doclinks" id="s132"><a href="../s132/index.html">S132 SoftDevice API</a></td>
<td class="doclinks" id="s140"><a href="../s140/index.html">S140 SoftDevice API</a></td>
<td class="doclinks" id="s212"><a href="../s212/index.html">S212 SoftDevice API</a></td>
<td class="doclinks" id="s312"><a href="../s312/index.html">S312 SoftDevice API</a></td>
<td class="doclinks" id="s332"><a href="../s332/index.html">S332 SoftDevice API</a></td>
<td class="doclinks" id="s340"><a href="../s340/index.html">S340 SoftDevice API</a></td>
</tr>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s112","s132","s140","s212","s312","s332","s340"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('lib_iot_security.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Transport Layer Security on nRF5 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="whichSDs"><span>This information applies to the following SoftDevice: <b>S132</b></span></div><h1><a class="anchor" id="lib_iot_security_overview"></a>
Overview</h1>
<p>Transport Layer Security (TLS) ensures privacy between server and client endpoints by providing protection against eavesdropping and the tampering of data exchanged between the communicating endpoints.</p>
<p>The Datagram Transport Layer Security (DTLS) defines transport layer security for datagram protocols thereby providing communications privacy for datagram protocols. The DTLS protocol is based on the Transport Layer Security (TLS) protocol and provides equivalent security guarantees. TLS assumes a reliable transport and breaks when re-hosted on an unreliable transport. DTLS aims at fixing this problem by proposing changes to allow the reordering of packets and by implementing retransmission timers to handle packet loss.</p>
<p>CoAP defines DTLS bindings for secure communication. MQTT defines bindings for TLS.</p>
<dl class="section note"><dt>Note</dt><dd>The term TLS covers both security for TCP and UDP transport types, this means DTLS is implied if the transport type is UDP.</dd></dl>
<div class="image">
<img src="IoT_security.svg" alt="IoT_security.svg"/>
<div class="caption">
Figure 1. End to end security with TLS/DTLS</div></div>
<p> <b>Figure 2</b> below shows the position of the TLS/DTLS layers in the Nordic IoT SDK.</p>
<div class="image">
<img src="Securityblockdiagram.png" alt="Securityblockdiagram.png"/>
<div class="caption">
Figure 2: Transport Layer Security on nRF5x</div></div>
 <h1><a class="anchor" id="lib_iot_security_interface"></a>
Nordic's TLS Abstraction Interface</h1>
<p>To avoid binding the users of the SDK with a specific TLS library, an abstracted interface is used in the SDK. This abstraction of TLS/DTLS is defined in <a class="el" href="group__iot__nrf__tls.html">TLS on nRF5x</a>. CoAP and MQTT rely on availability of this interface for securing their respective transport layers.</p>
<div class="image">
<img src="nrfTLS.png" alt="nrfTLS.png"/>
<div class="caption">
Figure 3: Nordic's TLS Abstraction Interface</div></div>
<p> In the SDK, <b>mbedtls</b> is used to provide the TLS interface to the IoT protocols. </p>
<dl class="section warning"><dt>Warning</dt><dd>Please read and understand the terms of use of <b>mbedtls</b>, which is published under the <a href="https://github.com/ARMmbed/mbedtls/blob/development/LICENSE" target="_blank">Apache 2.0 license</a>.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The current interface is minimalistic and strips down many of the functionalities like the session tickets, session caching etc. The interface will be extended in the future to add the relevant features.</dd></dl>
<h2><a class="anchor" id="lib_iot_security_config_table"></a>
Feature Configuration Summary</h2>
<p>Currently DTLS and TLS are maintained as two different configurations. The table below summarizes the features supported in the two configurations.</p>
<table class="doxtable">
<tr>
<th>Feature </th><th>DTLS </th><th>TLS</th></tr>
<tr>
<td>Role </td><td>Server and Client </td><td>Client only </td></tr>
<tr>
<td>Ciphers </td><td>TLS_PSK_WITH_AES_128_CCM_8 </td><td>TLS_PSK_WITH_AES_128_CBC_SHA <br/>
 TLS_PSK_WITH_AES_256_CBC_SHA <br/>
 TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA <br/>
 TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA </td></tr>
<tr>
<td>Max Fragment Length </td><td>1024 </td><td>3072 </td></tr>
<tr>
<td>Maximum concurrent sessions </td><td>2 </td><td>1 </td></tr>
</table>
<dl class="section warning"><dt>Warning</dt><dd>The raw public key mandated by <a href="https://datatracker.ietf.org/doc/rfc7252" target="_blank">RFC 7252</a> is not supported.</dd></dl>
<p>Configuration of mbedtls as TLS client used in all MQTT examples can be found at <br/>
 <code> &lt;InstallFolder&gt;components/iot/tls/mbedtls/tls/config</code>. Configuration of mbedtls as DTLS server and client used for CoAP DTLS examples can be found at <br/>
 <code> &lt;InstallFolder&gt;components/iot/tls/mbedtls/dtls/config</code>.</p>
<h2><a class="anchor" id="lib_iot_security_api"></a>
Application Interface</h2>
<p>This section describes the application interface of this module.</p>
<ul>
<li>
Create TLS/DTLS instance using <a class="el" href="group__iot__nrf__tls.html#gacd6ba4436554baf572b37121d5f27e0b">nrf_tls_alloc</a> : The cipher suites, protocol versions are fixed by the library. User is permitted to select the key settings, transport type and role. For client roles, a handshake is automatically initiated if the interface configuration and context setup was successful. </li>
<li>
Free the TLS instance <a class="el" href="group__iot__nrf__tls.html#gad76e480870511ed3062320bcb313bb09">nrf_tls_free</a> : All information and configuration for the instance is removed.  </li>
<li>
Write on the instance <a class="el" href="group__iot__nrf__tls.html#gaf4f847174293863c1b546fae8337cc75">nrf_tls_write</a> : This API is used to provide application data which is encrypted by the library for secure transfer to the remote endpoint.<dl class="section note"><dt>Note</dt><dd>Application should not attempt to send data more than the maximum fragment length configured.  </dd></dl>
</li>
<li>
Read on the instance <a class="el" href="group__iot__nrf__tls.html#ga0ca87c51875a1e206d50ab9277dae867">nrf_tls_read</a> : This procedure is used to retrieve any decrypted application data received from the remote end point. </li>
<li>
Transport data input <a class="el" href="group__iot__nrf__tls.html#gaa328f63bbc533db0904ed1c8fb3d42f2">nrf_tls_input</a> : All data received on the transport should be submitted to the library using this call. The library takes care of advancing the handshake protocol or decrypting data received based on the state of TLS connection.  </li>
<li>
Transport data write <a class="el" href="group__iot__nrf__tls.html#gac8b9aaa06755c2e333fb1eeff423918a">nrf_tls_output_t</a> : Callback registered with the TLS interface to write output of TLS library on to the associated transport interface. </li>
<li>
Heartbeat for the library <a class="el" href="group__iot__nrf__tls.html#ga542332cddc334c70bb842a9b732965f4">nrf_tls_process</a> : This call shall be made periodically to be able to process any queued input or output data in the TLS library.<dl class="section note"><dt>Note</dt><dd>The periodicity of calling this function has an impact on time taken to complete handshake protocol. </dd></dl>
</li>
</ul>
<h1><a class="anchor" id="mbedtls"></a>
Version and Reference</h1>
<p>The repository for <b>mbedtls</b> source is located at <a href="https://github.com/ARMmbed/mbedtls" target="_blank">mbedTLS GitHub</a>. mbedtls version included in the SDK is the tag <b>mbedtls-2.4.2</b>, corresponding hash is <b>59ae96f167a19f4d04dc6db61f6587b37ccd429f</b>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Fri Feb 15 2019" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
